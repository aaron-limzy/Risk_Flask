SELECT BaseSymbol as `SYMBOL`, SUM(YesterdayVolume) AS YesterdayVolume, -1 * SUM(YesterdayProfit_usd) AS YesterdayProfitUsd,
        -1 * SUM(YesterdayMarkupRebate) AS YesterdayRebate, now() as YESTERDAY_DATETIME_PULL
        FROM
            #yestClosed live 1
            (SELECT `Group`,yestTable.Symbol,YesterdayVolume,YesterdayProfit_usd,YesterdayMarkupRebate,BaseSymbol FROM
                (SELECT `Group`,Symbol, SUM(GroupMarkup)AS YesterdayMarkupRebate,SUM(ClosedVolume) AS YesterdayVolume,SUM(ClosedProfit_usd) AS YesterdayProfit_usd
                FROM mt5.yudi_daily_pnl_by_group_login_symbol WHERE DATE = DATE(NOW() - INTERVAL 7 HOUR)- INTERVAL 1 DAY AND`Group` LIKE "Real%" 
                AND `Group` NOT LIKE "Real_Futures%" AND `GROUP` NOT LIKE "%\\\\B\_%"
                GROUP BY `Group`,Symbol
                )yestTable
                LEFT JOIN 
                ( SELECT Symbol, BaseSymbol FROM mt5.yudi_BaseSymbol)yt2
                ON yestTable.Symbol = yt2.Symbol 
            UNION ALL
            #yestClosed live 2
            SELECT `Group`,yestTable.Symbol,YesterdayVolume,YesterdayProfit_usd,YesterdayMarkupRebate,BaseSymbol FROM
                (SELECT `Group`,Symbol, SUM(GroupMarkup)AS YesterdayMarkupRebate,SUM(ClosedVolume) AS YesterdayVolume,SUM(ClosedProfit_usd) AS YesterdayProfit_usd
                FROM mt5_uk.yudi_daily_pnl_by_group_login_symbol WHERE DATE = DATE(NOW() - INTERVAL 7 HOUR)- INTERVAL 1 DAY AND`Group` LIKE "Real%" 
                AND `Group` NOT LIKE "Real_Futures%" AND `GROUP` NOT LIKE "%\\\\B\_%"
                GROUP BY `Group`,Symbol
                )yestTable
                LEFT JOIN 
                ( SELECT Symbol, BaseSymbol FROM mt5_uk.yudi_BaseSymbol)yt2
                ON yestTable.Symbol = yt2.Symbol 
        )z2 group by BaseSymbol 